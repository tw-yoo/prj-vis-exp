<div class="page-content tutorial-page tutorial-page--example">
    <header class="tutorial-header">
        <div>
<!--            <p class="eyebrow">Tutorial • What you will do</p>-->
            <h1>Create a compositional question from a chart</h1>
            <p class="lede">
<!--                In this study, you will (1) <strong>read</strong> a given chart; (2) <strong>create</strong> a compositional question that can be answered from the chart; (3) <strong>calculate</strong> the answer; (4) <strong>mark</strong> what kind of arithmetic operations did you use to get the answer; (5) <strong>explain</strong> how did you get the answer.</p>-->
<!--                You’ll read a chart, write a multi-step question, calculate the single correct answer (with any calculator/tool you like),-->
<!--                select the operations you used (hover to see what each means), and explain your steps.-->
        </div>

        <div class="steps-box">
            <p>To successfully complete the study, please follow this steps:</p>
            <ol class="steps">
                <li><strong>Read</strong> the given chart carefully.</li>
                <li><strong>Create</strong> one compositional question whose answer can be obtained from the chart
                    (i.e., a question that combines at least two pieces of information from the chart).</li>
                <li><strong>Explain</strong> the steps you would follow to get the answer, in order.</li>
                <li><strong>Mark</strong> which arithmetic operations you use
                    (e.g., retrive value, filter, sort, compare).</li>
                <li><strong>Repeat</strong> these steps until you have created 20 questions in total.</li>
            </ol>
        </div>
        <div class="reminder">
            <strong>Important:</strong> Use tools to calculate the answer, or proofread the question and explanation, but <strong>do not use LLMs to generate the question itself.</strong>
        </div>
    </header>

    <div class="example-grid">
        <section class="card chart-card">
            <div class="card-header">
                <h3>Chart to read</h3>
<!--                <p class="hint">Look over the chart first. All answers should be derived from this chart.</p>-->
            </div>
            <div id="tutorial-chart-view__host" class="chart-host tutorial-example-chart" data-spec-path="pages/tutorial/tutorial_chart.json">
                <div id="tutorial-chart-view" class="d3chart-container">
                    <div class="chart-placeholder">Chart will appear here.</div>
                </div>
            </div>
        </section>

        <section class="card form-card">
            <div class="card-header">
                <h3>Try it exactly like the survey</h3>
<!--                <p class="hint">Fill 1–2 first, then continue to operations and explanation.</p>-->
            </div>

            <div class="form-body">
                <div class="stage-panel is-active">
                    <div data-component="open-ended"
                         data-id="q-question"
                         data-labelText="1. Your Question"
                         data-placeholder="What is the average of combined foggy and rainy day?"
                         data-multiline="true"></div>

                    <div data-component="open-ended"
                         data-id="q-explanation"
                         data-labelText="2. Step-by-Step Explanation to Get the Answer"
                         data-placeholder="1. Get the sum of foggy days: 411&#10;2. Get the sum of rainy days: 259&#10;3. Average value is (411 + 259)/12 = 27.9"
                         data-multiline="true"></div>
                </div>

                <div class="stage-panel is-active ops-section">
                    <div class="qa-review">
                        <div class="qa-review-item">
                            <span class="qa-review-label">1. Your Question</span>
                            <span class="qa-review-text" id="qa-review-question">No question yet.</span>
                        </div>
                        <div class="qa-review-item">
                            <span class="qa-review-label">2. Explanation (Step-by-step)</span>
                            <span class="qa-review-text" id="qa-review-explanation">No explanation yet.</span>
                        </div>
                    </div>

                    <div class="ops-checklist">
                        <label class="question">3. Operations Used (hover for meaning)</label>
                        <div class="ops-checklist-body" id="ops-checklist">
                            <label class="ops-check" data-tip="Placeholder description for Filter.">
                                <input type="checkbox" value="Filter">
                                <span>Filter</span>
                            </label>
                            <label class="ops-check" data-tip="Placeholder description for Sort.">
                                <input type="checkbox" value="Sort">
                                <span>Sort</span>
                            </label>
                            <label class="ops-check" data-tip="Placeholder description for Sum.">
                                <input type="checkbox" value="Sum">
                                <span>Sum</span>
                            </label>
                            <label class="ops-check" data-tip="Placeholder description for Average.">
                                <input type="checkbox" value="Average">
                                <span>Average</span>
                            </label>
                            <label class="ops-check" data-tip="Placeholder description for Difference.">
                                <input type="checkbox" value="Difference">
                                <span>Difference</span>
                            </label>
                            <label class="ops-check" data-tip="Placeholder description for Find Extremum.">
                                <input type="checkbox" value="Find Extremum">
                                <span>Find Extremum</span>
                            </label>
                            <label class="ops-check" data-tip="Placeholder description for Nth.">
                                <input type="checkbox" value="Nth">
                                <span>Nth</span>
                            </label>
                        </div>
                        <div class="ops-custom">
                            <label class="question optional-question" for="ops-custom-input">Other operations (add/remove)</label>
                            <div class="ops-custom-input-row">
                                <input id="ops-custom-input" type="text" placeholder="Add an operation and press + or Enter">
                                <button type="button" id="ops-custom-add-btn" class="ops-custom-add" aria-label="Add custom operation">+</button>
                            </div>
                            <div class="ops-custom-list" id="ops-custom-list"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    
</div>

<script>
// Lightweight custom-op handler for the tutorial page
(function() {
    const input = document.getElementById('ops-custom-input');
    const addBtn = document.getElementById('ops-custom-add-btn');
    const list = document.getElementById('ops-custom-list');
    if (!input || !addBtn || !list) return;

    const addOp = () => {
        const value = (input.value || '').trim();
        if (!value) return;
        const exists = Array.from(list.querySelectorAll('[data-value]')).some(el => (el.dataset.value || '').toLowerCase() === value.toLowerCase());
        if (exists) {
            input.value = '';
            return;
        }
        const chip = document.createElement('div');
        chip.className = 'ops-chip';
        chip.dataset.value = value;
        const label = document.createElement('span');
        label.className = 'ops-chip__label';
        label.textContent = value;
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'ops-chip__remove';
        remove.textContent = '-';
        remove.addEventListener('click', () => chip.remove());
        chip.append(label, remove);
        list.appendChild(chip);
        input.value = '';
        input.focus();
    };

    addBtn.addEventListener('click', addOp);
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            addOp();
        }
    });
})();
</script>
