<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>prj-vis-exp</title>

  <script src="https://d3js.org/d3.v6.min.js" defer></script>

  <!-- CodeMirror -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/closebrackets.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/matchbrackets.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega@5/build/vega.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6/build/vega-embed.min.js"></script>

  <!-- Vega/Vega-Lite -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

</head>

<body>
  <div id="container">
    <div id="left-panel">
      <div class="row-header">
        <div class="label">Vega-Lite Spec</div>
        <button id="render-chart-button" style="height: 24px;">Render Chart</button>
      </div>
      <div id="vl-error" style="color: red; font-family: sans-serif; font-size: 0.9em;"></div>
      <textarea id="vl-spec" placeholder="Paste Vega-Lite JSON here">
{
  "$schema": "https://vega.github.io/schema/vega-lite/v3.json",
  "description": "Population Census for year 2000, grouped by age and gender",
  "data": {
    "url": "data/test/data/bar_grouped_ver.csv"
  },
  "mark": "bar",
  "encoding": {
    "column": {
      "field": "age",
      "type": "ordinal",
      "spacing": 5
    },
    "y": {
      "aggregate": "sum",
      "field": "people",
      "type": "quantitative",
      "axis": {
        "title": "Population",
        "grid": false
      }
    },
    "x": {
      "field": "gender",
      "type": "nominal",
      "scale": {
        "rangeStep": 12
      },
      "axis": {
        "title": ""
      }
    },
    "color": {
      "field": "gender",
      "type": "nominal",
      "scale": {
        "range": ["#EA98D2", "#659CCA"]
      }
    }
  },
  "config": {
    "view": {
      "stroke": "transparent"
    },
    "axis": {
      "domainWidth": 1
    }
  }
}
      
      </textarea>

      <div class="row-header">
        <div class="label">Question</div>
        <button id="answer-button" style="height: 24px;">Get Answer</button>
      </div>
      <div>
        <textarea id="question" placeholder="Question"></textarea>
      </div>

      <div class="row-header">
        <div class="label">Answer</div>
      </div>
      <div>
        <textarea id="explanation" readonly>Baseline Explanation Here</textarea>
      </div>

      <div class="row-header">
        <div class="label">ChartOps Spec</div>
        <button id="run-ops-button" style="height: 24px;">Run Operations</button>
      </div>
      <div id="ops-error" style="color: red; font-family: sans-serif; font-size: 0.9em;"></div>
      <textarea id="ops-spec" placeholder="Paste Atomic-Ops JSON here">
   {
        "description": "Female 그룹에 focus 후, 인구수가 많은 순으로 정렬합니다.",
        "ops": [
            {
                "op": "focus",
                "key": "Female"
            },
            {
                "op": "sort",
                "field": "people",
                "order": "descending"
            }
        ]
    }

   </textarea>
    </div>
    <div></div>
    <div id="right-panel">
      <div id="chart"></div>
      <div id="ops-info-box" style="margin-top: 10px; color: #c00; font-family: sans-serif; font-size: 2em;"></div>
    </div>
  </div>

  <script type="module" src="index.js"></script>
  <!--  <script type="module" src="functions.js"></script>-->

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      window.vlEditor = CodeMirror.fromTextArea(document.getElementById("vl-spec"), {
        mode: { name: "javascript", json: true },
        lineNumbers: true,
        autoCloseBrackets: true,
        matchBrackets: true,
        indentUnit: 2
      });
      window.questionEditor = CodeMirror.fromTextArea(document.getElementById("question"), {
        mode: { name: "javascript", json: false },
        lineNumbers: true,
        autoCloseBrackets: true,
        matchBrackets: true,
        indentUnit: 2
      });
      window.opsEditor = CodeMirror.fromTextArea(document.getElementById("ops-spec"), {
        mode: { name: "javascript", json: true },
        lineNumbers: true,
        autoCloseBrackets: true,
        matchBrackets: true,
        indentUnit: 2
      });
    });
  </script>
</body>

</html>

